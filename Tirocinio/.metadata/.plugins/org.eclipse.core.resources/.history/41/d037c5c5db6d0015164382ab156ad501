package it.sp4te.CooperativeSpectrumSensing.Functions;

import java.util.ArrayList;

import it.sp4te.CooperativeSpectrumSensing.DomainModel.Noise;
import it.sp4te.CooperativeSpectrumSensing.DomainModel.Signal;



public class Moment {

 
    public double snr;
	public ArrayList<Double> samplesRe;
	public ArrayList<Double> samplesIm;
	public int attempts;	
	public ArrayList<Double> avarage;
	public ArrayList<Double> q;
	public ArrayList<Double> Energy;
    
	
/*Costruttore*/
	
	public Moment(Signal s, int attempts) {
		this.avarage= new ArrayList<Double>();
		this.q= new ArrayList<Double>();;
		this.attempts = attempts;
		this.Energy=new ArrayList<Double>();
		if(s!=null){
		
		this.samplesRe= s.getSamplesRe();
		this.samplesIm= s.getSamplesIm();}
		else{
			
			this.samplesRe=null;
			this.samplesIm=null;
			
		}
		
	}

	/*Calcola momenti del secondo e quarto ordine*/
	
	public void generateMoment(double energy,double snr,int length) {
		this.snr=snr;
       
		for (int i = 0; i < this.attempts; i++) {
			double j = 0.0;
			double h=0.0;
			
			Noise noise = new Noise(snr,length,energy);
			
			
			Signal signal= new Signal(noise.getNoiseLenght());
			
			signal.setSamplesRe(MathFunctions.SumVector(noise.getSamplesRe(),
					this.samplesRe));
			signal.setSamplesIm(MathFunctions.SumVector(noise.getSamplesIm(),
					this.samplesIm));
			
						
			this.Energy.add(i,SignalFunctions.signalEnergy(signal));
			
			for (int k = 1; k < noise.getNoiseLenght()-1; k++) {
            
 
				j =  (j + Math.pow(signal.getSamplesRe().get(k), 2)+ Math.pow(signal.getSamplesIm().get(k), 2));
				h =  (h + Math.pow(signal.getSamplesRe().get(k), 4)+ Math.pow(signal.getSamplesIm().get(k), 4));
			}
			
			this.avarage.add(i, j * (1 / (double) y.getLunghezzaSegnale()));
			this.q.add(i, h * (1 /(double) y.getLunghezzaSegnale()));
		}

	
	}

	
	
	
	/**
	 * @return
	 * @uml.property  name="media"
	 */
	public ArrayList<Double> getMedia() {
		return media;
	}

	

	/**
	 * @return
	 * @uml.property  name="q"
	 */
	public ArrayList<Double> getQ() {
		return q;
	}

	/**
	 * @return
	 * @uml.property  name="snr"
	 */
	public double getSnr(){
		return this.snr;
	}
	
	public ArrayList<Double> getPotenza(){
		return this.PotenzaSegnale;
		
	}

	

}

