package it.CooperativeSpectrumSensing.Agents;

import java.util.ArrayList;

import Grafico.GeneratoreGrafici;
import Operazioni.CalcoloDelleDetection;
import Operazioni.CalcoloSoglie;
import it.sp4te.CooperativeSpectrumSensing.Detection.Detection;
import it.sp4te.CooperativeSpectrumSensing.Detection.Threshold;
import it.sp4te.CooperativeSpectrumSensing.DomainModel.Signal;
import it.sp4te.CooperativeSpectrumSensing.Functions.Moment;
import it.sp4te.CooperativeSpectrumSensing.Functions.Pr;
import it.sp4te.CooperativeSpectrumSensing.Functions.SignalFunctions;



public class SecondaryUser {
	
	
	public static double SpectrumSensingEnergyDetector(Signal s,int length,double energy,int attempts,int inf,int sup) {
	//Genero i momenti nelle due ipotesi h0 e h1
	ArrayList<Moment> MomentsSignal =SignalFunctions.momentGenerator(s, length, energy, attempts, inf, sup);
	ArrayList<Moment> MomentsNoise =SignalFunctions.momentGenerator(null, length, energy, attempts, inf, sup);
    
	//Calcolo l'energia
	ArrayList<ArrayList<Double> > MomentSignalEnergy = SignalFunctions.momentEnergy(MomentsSignal);
	ArrayList<ArrayList<Double> > MomentNoiseEnergy = SignalFunctions.momentEnergy(MomentsNoise);
	
	//Genero Pr
	ArrayList<Pr> Pr = SignalFunctions.prGenerators(MomentsSignal);
	
	
	Map<Integer,Double> PowerDetection= new Map<Integer,Double>();
	for(int i=0;i<MomentSignalEnergy.size();i++){
	Detection.EnergyDetection(Threshold.EnergyDetectorThreshold(0.01, MomentNoiseEnergy.get(i)), MomentSignalEnergy.get(i));
	
	
	for(int i=0;i<this.Potenza1.size();i++){
		serie.add(this.PRSegnale.get(i).getMomenti().getSnr(),CalcoloDelleDetection.calcoloPowerDetection(CalcoloSoglie.calcoloSogliaPD(0.01,this.Potenza2.get(i)), this.Potenza1.get(i)));	
		}
}
